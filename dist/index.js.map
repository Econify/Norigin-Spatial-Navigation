{"version":3,"file":"index.js","mappings":"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","sources":["webpack://@noriginmedia/norigin-spatial-navigation/webpack/universalModuleDefinition","webpack://@noriginmedia/norigin-spatial-navigation/./src/SpatialNavigation.ts","webpack://@noriginmedia/norigin-spatial-navigation/./src/VisualDebugger.ts","webpack://@noriginmedia/norigin-spatial-navigation/./src/WritingDirection.ts","webpack://@noriginmedia/norigin-spatial-navigation/./src/index.ts","webpack://@noriginmedia/norigin-spatial-navigation/./src/measureLayout.ts","webpack://@noriginmedia/norigin-spatial-navigation/./src/useFocusContext.ts","webpack://@noriginmedia/norigin-spatial-navigation/./src/useFocusable.ts","webpack://@noriginmedia/norigin-spatial-navigation/./src/utils.ts","webpack://@noriginmedia/norigin-spatial-navigation/external umd \"react\"","webpack://@noriginmedia/norigin-spatial-navigation/webpack/bootstrap","webpack://@noriginmedia/norigin-spatial-navigation/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"react\")) : factory(root[\"react\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function(__WEBPACK_EXTERNAL_MODULE__156__) {\nreturn ","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.updateRtl = exports.doesFocusableExist = exports.getCurrentFocusKey = exports.updateAllLayouts = exports.resume = exports.pause = exports.navigateByDirection = exports.setFocus = exports.setKeyMap = exports.destroy = exports.setThrottle = exports.init = exports.SpatialNavigation = exports.ROOT_FOCUS_KEY = void 0;\nvar VisualDebugger_1 = __importDefault(require(\"./VisualDebugger\"));\nvar WritingDirection_1 = __importDefault(require(\"./WritingDirection\"));\nvar measureLayout_1 = __importStar(require(\"./measureLayout\"));\nvar utils_1 = require(\"./utils\");\nvar DIRECTION_LEFT = 'left';\nvar DIRECTION_RIGHT = 'right';\nvar DIRECTION_UP = 'up';\nvar DIRECTION_DOWN = 'down';\nvar KEY_ENTER = 'enter';\nvar DEFAULT_KEY_MAP = (_a = {},\n    _a[DIRECTION_LEFT] = [37, 'ArrowLeft'],\n    _a[DIRECTION_UP] = [38, 'ArrowUp'],\n    _a[DIRECTION_RIGHT] = [39, 'ArrowRight'],\n    _a[DIRECTION_DOWN] = [40, 'ArrowDown'],\n    _a[KEY_ENTER] = [13, 'Enter'],\n    _a);\nexports.ROOT_FOCUS_KEY = 'SN:ROOT';\nvar ADJACENT_SLICE_THRESHOLD = 0.2;\n/**\n * Adjacent slice is 5 times more important than diagonal\n */\nvar ADJACENT_SLICE_WEIGHT = 5;\nvar DIAGONAL_SLICE_WEIGHT = 1;\n/**\n * Main coordinate distance is 5 times more important\n */\nvar MAIN_COORDINATE_WEIGHT = 5;\nvar AUTO_RESTORE_FOCUS_DELAY = 300;\nvar DEBUG_FN_COLORS = ['#0FF', '#FF0', '#F0F'];\nvar THROTTLE_OPTIONS = {\n    leading: true,\n    trailing: false\n};\nvar getChildClosestToOrigin = function (children, writingDirection) {\n    var comparator = writingDirection === WritingDirection_1.default.LTR\n        ? function (a, b) {\n            return (Math.abs(a.layout.left) + Math.abs(a.layout.top)) -\n                (Math.abs(b.layout.left) + Math.abs(b.layout.top));\n        }\n        : function (a, b) {\n            return (Math.abs(window.innerWidth - a.layout.right) + Math.abs(a.layout.top)) -\n                (Math.abs(window.innerWidth - b.layout.right) + Math.abs(b.layout.top));\n        };\n    var childrenClosestToOrigin = children.sort(comparator);\n    return childrenClosestToOrigin[0];\n};\n/**\n * Takes either a BackwardsCompatibleKeyMap and transforms it into a the new KeyMap format\n * to ensure backwards compatibility.\n */\nvar normalizeKeyMap = function (keyMap) {\n    var newKeyMap = {};\n    Object.entries(keyMap).forEach(function (_a) {\n        var key = _a[0], value = _a[1];\n        newKeyMap[key] = Array.isArray(value) ? value : [value];\n    });\n    return newKeyMap;\n};\nvar SpatialNavigationService = /** @class */ (function () {\n    function SpatialNavigationService() {\n        /**\n         * Storage for all focusable components\n         */\n        this.focusableComponents = {};\n        /**\n         * Storing current focused key\n         */\n        this.focusKey = null;\n        /**\n         * This collection contains focus keys of the elements that are having a child focused\n         * Might be handy for styling of certain parent components if their child is focused.\n         */\n        this.parentsHavingFocusedChild = [];\n        this.domNodeFocusOptions = {};\n        this.enabled = false;\n        this.nativeMode = false;\n        this.throttle = 0;\n        this.throttleKeypresses = false;\n        this.useGetBoundingClientRect = false;\n        this.shouldFocusDOMNode = false;\n        this.shouldUseNativeEvents = false;\n        this.writingDirection = WritingDirection_1.default.LTR;\n        this.pressedKeys = {};\n        /**\n         * Flag used to block key events from this service\n         * @type {boolean}\n         */\n        this.paused = false;\n        this.keyDownEventListener = null;\n        this.keyUpEventListener = null;\n        this.keyMap = DEFAULT_KEY_MAP;\n        this.pause = this.pause.bind(this);\n        this.resume = this.resume.bind(this);\n        this.setFocus = this.setFocus.bind(this);\n        this.updateAllLayouts = this.updateAllLayouts.bind(this);\n        this.navigateByDirection = this.navigateByDirection.bind(this);\n        this.init = this.init.bind(this);\n        this.setThrottle = this.setThrottle.bind(this);\n        this.destroy = this.destroy.bind(this);\n        this.setKeyMap = this.setKeyMap.bind(this);\n        this.getCurrentFocusKey = this.getCurrentFocusKey.bind(this);\n        this.doesFocusableExist = this.doesFocusableExist.bind(this);\n        this.updateRtl = this.updateRtl.bind(this);\n        this.setFocusDebounced = (0, utils_1.debounce)(this.setFocus, AUTO_RESTORE_FOCUS_DELAY, {\n            leading: false,\n            trailing: true\n        });\n        this.debug = false;\n        this.visualDebugger = null;\n        this.logIndex = 0;\n        this.distanceCalculationMethod = 'corners';\n    }\n    /**\n     * Used to determine the coordinate that will be used to filter items that are over the \"edge\"\n     */\n    SpatialNavigationService.getCutoffCoordinate = function (isVertical, isIncremental, isSibling, layout, writingDirection) {\n        var itemStart = isVertical\n            ? layout.top\n            : writingDirection === WritingDirection_1.default.LTR\n                ? layout.left\n                : layout.right;\n        var itemEnd = isVertical\n            ? layout.bottom\n            : writingDirection === WritingDirection_1.default.LTR\n                ? layout.right\n                : layout.left;\n        return isIncremental\n            ? isSibling\n                ? itemStart\n                : itemEnd\n            : isSibling\n                ? itemEnd\n                : itemStart;\n    };\n    /**\n     * Returns two corners (a and b) coordinates that are used as a reference points\n     * Where \"a\" is always leftmost and topmost corner, and \"b\" is rightmost bottommost corner\n     */\n    SpatialNavigationService.getRefCorners = function (direction, isSibling, layout) {\n        var result = {\n            a: {\n                x: 0,\n                y: 0\n            },\n            b: {\n                x: 0,\n                y: 0\n            }\n        };\n        switch (direction) {\n            case DIRECTION_UP: {\n                var y = isSibling ? layout.bottom : layout.top;\n                result.a = {\n                    x: layout.left,\n                    y: y\n                };\n                result.b = {\n                    x: layout.right,\n                    y: y\n                };\n                break;\n            }\n            case DIRECTION_DOWN: {\n                var y = isSibling ? layout.top : layout.bottom;\n                result.a = {\n                    x: layout.left,\n                    y: y\n                };\n                result.b = {\n                    x: layout.right,\n                    y: y\n                };\n                break;\n            }\n            case DIRECTION_LEFT: {\n                var x = isSibling ? layout.right : layout.left;\n                result.a = {\n                    x: x,\n                    y: layout.top\n                };\n                result.b = {\n                    x: x,\n                    y: layout.bottom\n                };\n                break;\n            }\n            case DIRECTION_RIGHT: {\n                var x = isSibling ? layout.left : layout.right;\n                result.a = {\n                    x: x,\n                    y: layout.top\n                };\n                result.b = {\n                    x: x,\n                    y: layout.bottom\n                };\n                break;\n            }\n            default:\n                break;\n        }\n        return result;\n    };\n    /**\n     * Calculates if the sibling node is intersecting enough with the ref node by the secondary coordinate\n     */\n    SpatialNavigationService.isAdjacentSlice = function (refCorners, siblingCorners, isVerticalDirection) {\n        var refA = refCorners.a, refB = refCorners.b;\n        var siblingA = siblingCorners.a, siblingB = siblingCorners.b;\n        var coordinate = isVerticalDirection ? 'x' : 'y';\n        var refCoordinateA = refA[coordinate];\n        var refCoordinateB = refB[coordinate];\n        var siblingCoordinateA = siblingA[coordinate];\n        var siblingCoordinateB = siblingB[coordinate];\n        var thresholdDistance = (refCoordinateB - refCoordinateA) * ADJACENT_SLICE_THRESHOLD;\n        var intersectionLength = Math.max(0, Math.min(refCoordinateB, siblingCoordinateB) -\n            Math.max(refCoordinateA, siblingCoordinateA));\n        return intersectionLength >= thresholdDistance;\n    };\n    SpatialNavigationService.getPrimaryAxisDistance = function (refCorners, siblingCorners, isVerticalDirection) {\n        var refA = refCorners.a;\n        var siblingA = siblingCorners.a;\n        var coordinate = isVerticalDirection ? 'y' : 'x';\n        return Math.abs(siblingA[coordinate] - refA[coordinate]);\n    };\n    SpatialNavigationService.getSecondaryAxisDistance = function (refCorners, siblingCorners, isVerticalDirection, distanceCalculationMethod, customDistanceCalculationFunction) {\n        if (customDistanceCalculationFunction) {\n            return customDistanceCalculationFunction(refCorners, siblingCorners, isVerticalDirection, distanceCalculationMethod);\n        }\n        var refA = refCorners.a, refB = refCorners.b;\n        var siblingA = siblingCorners.a, siblingB = siblingCorners.b;\n        var coordinate = isVerticalDirection ? 'x' : 'y';\n        var refCoordinateA = refA[coordinate];\n        var refCoordinateB = refB[coordinate];\n        var siblingCoordinateA = siblingA[coordinate];\n        var siblingCoordinateB = siblingB[coordinate];\n        if (distanceCalculationMethod === 'center') {\n            var refCoordinateCenter = (refCoordinateA + refCoordinateB) / 2;\n            var siblingCoordinateCenter = (siblingCoordinateA + siblingCoordinateB) / 2;\n            return Math.abs(refCoordinateCenter - siblingCoordinateCenter);\n        }\n        if (distanceCalculationMethod === 'edges') {\n            // 1. Find the minimum and maximum coordinates for both ref and sibling\n            var refCoordinateEdgeMin = Math.min(refCoordinateA, refCoordinateB);\n            var siblingCoordinateEdgeMin = Math.min(siblingCoordinateA, siblingCoordinateB);\n            var refCoordinateEdgeMax = Math.max(refCoordinateA, refCoordinateB);\n            var siblingCoordinateEdgeMax = Math.max(siblingCoordinateA, siblingCoordinateB);\n            // 2. Calculate the distances between the closest edges\n            var minEdgeDistance = Math.abs(refCoordinateEdgeMin - siblingCoordinateEdgeMin);\n            var maxEdgeDistance = Math.abs(refCoordinateEdgeMax - siblingCoordinateEdgeMax);\n            // 3. Return the smallest distance between the edges\n            return Math.min(minEdgeDistance, maxEdgeDistance);\n        }\n        // Default to corners\n        var distancesToCompare = [\n            Math.abs(siblingCoordinateA - refCoordinateA),\n            Math.abs(siblingCoordinateA - refCoordinateB),\n            Math.abs(siblingCoordinateB - refCoordinateA),\n            Math.abs(siblingCoordinateB - refCoordinateB)\n        ];\n        return Math.min.apply(Math, distancesToCompare);\n    };\n    /**\n     * Inspired by: https://developer.mozilla.org/en-US/docs/Mozilla/Firefox_OS_for_TV/TV_remote_control_navigation#Algorithm_design\n     * Ref Corners are the 2 corners of the current component in the direction of navigation\n     * They are used as a base to measure adjacent slices\n     */\n    SpatialNavigationService.prototype.sortSiblingsByPriority = function (siblings, currentLayout, direction, focusKey) {\n        var _this = this;\n        var isVerticalDirection = direction === DIRECTION_DOWN || direction === DIRECTION_UP;\n        var refCorners = SpatialNavigationService.getRefCorners(direction, false, currentLayout);\n        return siblings.sort(function (a, b) {\n            var siblingCornersA = SpatialNavigationService.getRefCorners(direction, true, a.layout);\n            var siblingCornersB = SpatialNavigationService.getRefCorners(direction, true, b.layout);\n            var isAdjacentSliceA = SpatialNavigationService.isAdjacentSlice(refCorners, siblingCornersA, isVerticalDirection);\n            var isAdjacentSliceB = SpatialNavigationService.isAdjacentSlice(refCorners, siblingCornersB, isVerticalDirection);\n            var primaryAxisFunctionA = isAdjacentSliceA\n                ? SpatialNavigationService.getPrimaryAxisDistance\n                : SpatialNavigationService.getSecondaryAxisDistance;\n            var primaryAxisFunctionB = isAdjacentSliceB\n                ? SpatialNavigationService.getPrimaryAxisDistance\n                : SpatialNavigationService.getSecondaryAxisDistance;\n            var secondaryAxisFunctionA = isAdjacentSliceA\n                ? SpatialNavigationService.getSecondaryAxisDistance\n                : SpatialNavigationService.getPrimaryAxisDistance;\n            var secondaryAxisFunctionB = isAdjacentSliceB\n                ? SpatialNavigationService.getSecondaryAxisDistance\n                : SpatialNavigationService.getPrimaryAxisDistance;\n            var primaryAxisDistanceA = primaryAxisFunctionA(refCorners, siblingCornersA, isVerticalDirection, _this.distanceCalculationMethod, _this.customDistanceCalculationFunction);\n            var primaryAxisDistanceB = primaryAxisFunctionB(refCorners, siblingCornersB, isVerticalDirection, _this.distanceCalculationMethod, _this.customDistanceCalculationFunction);\n            var secondaryAxisDistanceA = secondaryAxisFunctionA(refCorners, siblingCornersA, isVerticalDirection, _this.distanceCalculationMethod, _this.customDistanceCalculationFunction);\n            var secondaryAxisDistanceB = secondaryAxisFunctionB(refCorners, siblingCornersB, isVerticalDirection, _this.distanceCalculationMethod, _this.customDistanceCalculationFunction);\n            /**\n             * The higher this value is, the less prioritised the candidate is\n             */\n            var totalDistancePointsA = primaryAxisDistanceA * MAIN_COORDINATE_WEIGHT + secondaryAxisDistanceA;\n            var totalDistancePointsB = primaryAxisDistanceB * MAIN_COORDINATE_WEIGHT + secondaryAxisDistanceB;\n            /**\n             * + 1 here is in case of distance is zero, but we still want to apply Adjacent priority weight\n             */\n            var priorityA = (totalDistancePointsA + 1) /\n                (isAdjacentSliceA ? ADJACENT_SLICE_WEIGHT : DIAGONAL_SLICE_WEIGHT);\n            var priorityB = (totalDistancePointsB + 1) /\n                (isAdjacentSliceB ? ADJACENT_SLICE_WEIGHT : DIAGONAL_SLICE_WEIGHT);\n            _this.log('smartNavigate', \"distance (primary, secondary, total weighted) for \".concat(a.focusKey, \" relative to \").concat(focusKey, \" is\"), primaryAxisDistanceA, secondaryAxisDistanceA, totalDistancePointsA);\n            _this.log('smartNavigate', \"priority for \".concat(a.focusKey, \" relative to \").concat(focusKey, \" is\"), priorityA);\n            if (_this.visualDebugger) {\n                _this.visualDebugger.drawPoint(siblingCornersA.a.x, siblingCornersA.a.y, 'yellow', 6);\n                _this.visualDebugger.drawPoint(siblingCornersA.b.x, siblingCornersA.b.y, 'yellow', 6);\n            }\n            return priorityA - priorityB;\n        });\n    };\n    SpatialNavigationService.prototype.init = function (_a) {\n        var _this = this;\n        var _b = _a === void 0 ? {} : _a, _c = _b.debug, debug = _c === void 0 ? false : _c, _d = _b.visualDebug, visualDebug = _d === void 0 ? false : _d, _e = _b.nativeMode, nativeMode = _e === void 0 ? false : _e, _f = _b.throttle, throttleParam = _f === void 0 ? 0 : _f, _g = _b.throttleKeypresses, throttleKeypresses = _g === void 0 ? false : _g, _h = _b.useGetBoundingClientRect, useGetBoundingClientRect = _h === void 0 ? false : _h, _j = _b.shouldFocusDOMNode, shouldFocusDOMNode = _j === void 0 ? false : _j, _k = _b.domNodeFocusOptions, domNodeFocusOptions = _k === void 0 ? {} : _k, _l = _b.shouldUseNativeEvents, shouldUseNativeEvents = _l === void 0 ? false : _l, _m = _b.rtl, rtl = _m === void 0 ? false : _m, _o = _b.distanceCalculationMethod, distanceCalculationMethod = _o === void 0 ? 'corners' : _o, _p = _b.customDistanceCalculationFunction, customDistanceCalculationFunction = _p === void 0 ? undefined : _p;\n        if (!this.enabled) {\n            this.domNodeFocusOptions = domNodeFocusOptions;\n            this.enabled = true;\n            this.nativeMode = nativeMode;\n            this.throttleKeypresses = throttleKeypresses;\n            this.useGetBoundingClientRect = useGetBoundingClientRect;\n            this.shouldFocusDOMNode = shouldFocusDOMNode && !nativeMode;\n            this.shouldUseNativeEvents = shouldUseNativeEvents;\n            this.writingDirection = rtl ? WritingDirection_1.default.RTL : WritingDirection_1.default.LTR;\n            this.distanceCalculationMethod = distanceCalculationMethod;\n            this.customDistanceCalculationFunction =\n                customDistanceCalculationFunction;\n            this.debug = debug;\n            if (!this.nativeMode) {\n                if (Number.isInteger(throttleParam) && throttleParam > 0) {\n                    this.throttle = throttleParam;\n                }\n                this.bindEventHandlers();\n                if (visualDebug) {\n                    this.visualDebugger = new VisualDebugger_1.default(this.writingDirection);\n                    var draw_1 = function () {\n                        requestAnimationFrame(function () {\n                            _this.visualDebugger.clearLayouts();\n                            Object.keys(_this.focusableComponents).forEach(function (focusKey) {\n                                var component = _this.focusableComponents[focusKey];\n                                _this.visualDebugger.drawLayout(component.layout, focusKey, component.parentFocusKey);\n                            });\n                            draw_1();\n                        });\n                    };\n                    draw_1();\n                }\n            }\n        }\n    };\n    SpatialNavigationService.prototype.setThrottle = function (_a) {\n        var _b = _a === void 0 ? {} : _a, _c = _b.throttle, throttleParam = _c === void 0 ? 0 : _c, _d = _b.throttleKeypresses, throttleKeypresses = _d === void 0 ? false : _d;\n        this.throttleKeypresses = throttleKeypresses;\n        if (!this.nativeMode) {\n            this.unbindEventHandlers();\n            if (Number.isInteger(throttleParam)) {\n                this.throttle = throttleParam;\n            }\n            this.bindEventHandlers();\n        }\n    };\n    SpatialNavigationService.prototype.destroy = function () {\n        if (this.enabled) {\n            this.enabled = false;\n            this.nativeMode = false;\n            this.throttle = 0;\n            this.throttleKeypresses = false;\n            this.focusKey = null;\n            this.parentsHavingFocusedChild = [];\n            this.focusableComponents = {};\n            this.paused = false;\n            this.keyMap = DEFAULT_KEY_MAP;\n            this.unbindEventHandlers();\n        }\n    };\n    SpatialNavigationService.prototype.getEventType = function (keyCode) {\n        return (0, utils_1.findKey)(this.getKeyMap(), function (codeList) { return codeList.includes(keyCode); });\n    };\n    SpatialNavigationService.getKeyCode = function (event) {\n        return event.keyCode || event.code || event.key;\n    };\n    SpatialNavigationService.prototype.bindEventHandlers = function () {\n        var _this = this;\n        // We check both because the React Native remote debugger implements window, but not window.addEventListener.\n        if (typeof window !== 'undefined' && window.addEventListener) {\n            this.keyDownEventListener = function (event) {\n                if (_this.paused === true) {\n                    return;\n                }\n                if (_this.debug) {\n                    _this.logIndex += 1;\n                }\n                var keyCode = SpatialNavigationService.getKeyCode(event);\n                var eventType = _this.getEventType(keyCode);\n                if (!eventType) {\n                    return;\n                }\n                _this.pressedKeys[eventType] = _this.pressedKeys[eventType]\n                    ? _this.pressedKeys[eventType] + 1\n                    : 1;\n                if (!_this.shouldUseNativeEvents) {\n                    event.preventDefault();\n                    event.stopPropagation();\n                }\n                var keysDetails = {\n                    pressedKeys: _this.pressedKeys\n                };\n                if (eventType === KEY_ENTER && _this.focusKey) {\n                    _this.onEnterPress(keysDetails);\n                    return;\n                }\n                var preventDefaultNavigation = _this.onArrowPress(eventType, keysDetails) === false;\n                if (_this.visualDebugger) {\n                    _this.visualDebugger.clear();\n                }\n                if (preventDefaultNavigation) {\n                    _this.log('keyDownEventListener', 'default navigation prevented');\n                }\n                else {\n                    var direction = (0, utils_1.findKey)(_this.getKeyMap(), function (codeList) {\n                        return codeList.includes(keyCode);\n                    });\n                    _this.smartNavigate(direction, null, { event: event });\n                }\n            };\n            // Apply throttle only if the option we got is > 0 to avoid limiting the listener to every animation frame\n            if (this.throttle) {\n                this.keyDownEventListenerThrottled = (0, utils_1.throttle)(this.keyDownEventListener.bind(this), this.throttle, THROTTLE_OPTIONS);\n            }\n            // When throttling then make sure to only throttle key down and cancel any queued functions in case of key up\n            this.keyUpEventListener = function (event) {\n                var keyCode = SpatialNavigationService.getKeyCode(event);\n                var eventType = _this.getEventType(keyCode);\n                delete _this.pressedKeys[eventType];\n                if (_this.throttle && !_this.throttleKeypresses) {\n                    _this.keyDownEventListenerThrottled.cancel();\n                }\n                if (eventType === KEY_ENTER && _this.focusKey) {\n                    _this.onEnterRelease();\n                }\n                if (_this.focusKey && (eventType === DIRECTION_LEFT ||\n                    eventType === DIRECTION_RIGHT ||\n                    eventType === DIRECTION_UP ||\n                    eventType === DIRECTION_DOWN)) {\n                    _this.onArrowRelease(eventType);\n                }\n            };\n            window.addEventListener('keyup', this.keyUpEventListener);\n            window.addEventListener('keydown', this.throttle\n                ? this.keyDownEventListenerThrottled\n                : this.keyDownEventListener);\n        }\n    };\n    SpatialNavigationService.prototype.unbindEventHandlers = function () {\n        // We check both because the React Native remote debugger implements window, but not window.removeEventListener.\n        if (typeof window !== 'undefined' && window.removeEventListener) {\n            window.removeEventListener('keyup', this.keyUpEventListener);\n            this.keyUpEventListener = null;\n            var listener = this.throttle\n                ? this.keyDownEventListenerThrottled\n                : this.keyDownEventListener;\n            window.removeEventListener('keydown', listener);\n            this.keyDownEventListener = null;\n        }\n    };\n    SpatialNavigationService.prototype.onEnterPress = function (keysDetails) {\n        var component = this.focusableComponents[this.focusKey];\n        /* Guard against last-focused component being unmounted at time of onEnterPress (e.g due to UI fading out) */\n        if (!component) {\n            this.log('onEnterPress', 'noComponent');\n            return;\n        }\n        /* Suppress onEnterPress if the last-focused item happens to lose its 'focused' status. */\n        if (!component.focusable) {\n            this.log('onEnterPress', 'componentNotFocusable');\n            return;\n        }\n        if (component.onEnterPress) {\n            component.onEnterPress(keysDetails);\n        }\n    };\n    SpatialNavigationService.prototype.onEnterRelease = function () {\n        var component = this.focusableComponents[this.focusKey];\n        /* Guard against last-focused component being unmounted at time of onEnterRelease (e.g due to UI fading out) */\n        if (!component) {\n            this.log('onEnterRelease', 'noComponent');\n            return;\n        }\n        /* Suppress onEnterRelease if the last-focused item happens to lose its 'focused' status. */\n        if (!component.focusable) {\n            this.log('onEnterRelease', 'componentNotFocusable');\n            return;\n        }\n        if (component.onEnterRelease) {\n            component.onEnterRelease();\n        }\n    };\n    SpatialNavigationService.prototype.onArrowPress = function (direction, keysDetails) {\n        var component = this.focusableComponents[this.focusKey];\n        /* Guard against last-focused component being unmounted at time of onArrowPress (e.g due to UI fading out) */\n        if (!component) {\n            this.log('onArrowPress', 'noComponent');\n            return undefined;\n        }\n        /* It's okay to navigate AWAY from an item that has lost its 'focused' status, so we don't inspect\n         * component.focusable. */\n        return (component &&\n            component.onArrowPress &&\n            component.onArrowPress(direction, keysDetails));\n    };\n    SpatialNavigationService.prototype.onArrowRelease = function (direction) {\n        var component = this.focusableComponents[this.focusKey];\n        /* Guard against last-focused component being unmounted at time of onArrowRelease (e.g due to UI fading out) */\n        if (!component) {\n            this.log('onArrowRelease', 'noComponent');\n            return;\n        }\n        /* Suppress onArrowRelease if the last-focused item happens to lose its 'focused' status. */\n        if (!component.focusable) {\n            this.log('onArrowRelease', 'componentNotFocusable');\n            return;\n        }\n        if (component.onArrowRelease) {\n            component.onArrowRelease(direction);\n        }\n    };\n    /**\n     * Move focus by direction, if you can't use buttons or focusing by key.\n     *\n     * @example\n     * navigateByDirection('right') // The focus is moved to right\n     */\n    SpatialNavigationService.prototype.navigateByDirection = function (direction, focusDetails) {\n        if (this.paused === true || !this.enabled || this.nativeMode) {\n            return;\n        }\n        var validDirections = [\n            DIRECTION_DOWN,\n            DIRECTION_UP,\n            DIRECTION_LEFT,\n            DIRECTION_RIGHT\n        ];\n        if (validDirections.includes(direction)) {\n            this.log('navigateByDirection', 'direction', direction);\n            this.smartNavigate(direction, null, focusDetails);\n        }\n        else {\n            this.log('navigateByDirection', \"Invalid direction. You passed: `\".concat(direction, \"`, but you can use only these: \"), validDirections);\n        }\n    };\n    /**\n     * This function navigates between siblings OR goes up by the Tree\n     * Based on the Direction\n     */\n    SpatialNavigationService.prototype.smartNavigate = function (direction, fromParentFocusKey, focusDetails) {\n        var _this = this;\n        if (this.nativeMode) {\n            return;\n        }\n        var isVerticalDirection = direction === DIRECTION_DOWN || direction === DIRECTION_UP;\n        var isIncrementalDirection = direction === DIRECTION_DOWN ||\n            (this.writingDirection === WritingDirection_1.default.LTR\n                ? direction === DIRECTION_RIGHT\n                : direction === DIRECTION_LEFT);\n        this.log('smartNavigate', 'direction', direction);\n        this.log('smartNavigate', 'fromParentFocusKey', fromParentFocusKey);\n        this.log('smartNavigate', 'this.focusKey', this.focusKey);\n        if (!fromParentFocusKey) {\n            Object.values(this.focusableComponents).forEach(function (component) {\n                // eslint-disable-next-line no-param-reassign\n                component.layoutUpdated = false;\n            });\n        }\n        var currentComponent = this.focusableComponents[fromParentFocusKey || this.focusKey];\n        /**\n         * When there's no currently focused component, an attempt is made, to force focus one of\n         * the Focusable Containers, that have \"forceFocus\" flag enabled.\n         */\n        if (!fromParentFocusKey && !currentComponent) {\n            this.setFocus(this.getForcedFocusKey());\n            return;\n        }\n        this.log('smartNavigate', 'currentComponent', currentComponent ? currentComponent.focusKey : undefined, currentComponent ? currentComponent.node : undefined, currentComponent);\n        if (currentComponent) {\n            this.updateLayout(currentComponent.focusKey);\n            var parentFocusKey_1 = currentComponent.parentFocusKey, focusKey = currentComponent.focusKey, layout = currentComponent.layout;\n            var currentCutoffCoordinate_1 = SpatialNavigationService.getCutoffCoordinate(isVerticalDirection, isIncrementalDirection, false, layout, this.writingDirection);\n            /**\n             * Get only the siblings with the coords on the way of our moving direction\n             */\n            var siblings = Object.values(this.focusableComponents).filter(function (component) {\n                if (component.parentFocusKey === parentFocusKey_1 &&\n                    component.focusable) {\n                    _this.updateLayout(component.focusKey);\n                    var siblingCutoffCoordinate = SpatialNavigationService.getCutoffCoordinate(isVerticalDirection, isIncrementalDirection, true, component.layout, _this.writingDirection);\n                    return isVerticalDirection\n                        ? isIncrementalDirection\n                            ? siblingCutoffCoordinate >= currentCutoffCoordinate_1 // vertical next\n                            : siblingCutoffCoordinate <= currentCutoffCoordinate_1 // vertical previous\n                        : _this.writingDirection === WritingDirection_1.default.LTR\n                            ? isIncrementalDirection\n                                ? siblingCutoffCoordinate >= currentCutoffCoordinate_1 // horizontal LTR next\n                                : siblingCutoffCoordinate <= currentCutoffCoordinate_1 // horizontal LTR previous\n                            : isIncrementalDirection\n                                ? siblingCutoffCoordinate <= currentCutoffCoordinate_1 // horizontal RTL next\n                                : siblingCutoffCoordinate >= currentCutoffCoordinate_1; // horizontal RTL previous\n                }\n                return false;\n            });\n            if (this.debug) {\n                this.log('smartNavigate', 'currentCutoffCoordinate', currentCutoffCoordinate_1);\n                this.log('smartNavigate', 'siblings', \"\".concat(siblings.length, \" elements:\"), siblings.map(function (sibling) { return sibling.focusKey; }).join(', '), siblings.map(function (sibling) { return sibling.node; }), siblings.map(function (sibling) { return sibling; }));\n            }\n            if (this.visualDebugger) {\n                var refCorners = SpatialNavigationService.getRefCorners(direction, false, layout);\n                this.visualDebugger.drawPoint(refCorners.a.x, refCorners.a.y);\n                this.visualDebugger.drawPoint(refCorners.b.x, refCorners.b.y);\n            }\n            var sortedSiblings = this.sortSiblingsByPriority(siblings, layout, direction, focusKey);\n            var nextComponent = sortedSiblings[0];\n            this.log('smartNavigate', 'nextComponent', nextComponent ? nextComponent.focusKey : undefined, nextComponent ? nextComponent.node : undefined, nextComponent);\n            if (nextComponent) {\n                this.setFocus(nextComponent.focusKey, focusDetails);\n            }\n            else {\n                var parentComponent = this.focusableComponents[parentFocusKey_1];\n                var focusBoundaryDirections = (parentComponent === null || parentComponent === void 0 ? void 0 : parentComponent.isFocusBoundary)\n                    ? parentComponent.focusBoundaryDirections || [direction]\n                    : [];\n                if (!parentComponent || !focusBoundaryDirections.includes(direction)) {\n                    this.smartNavigate(direction, parentFocusKey_1, focusDetails);\n                }\n                else {\n                    currentComponent.onBoundaryHit(direction);\n                    parentComponent.onBoundaryHit(direction);\n                }\n            }\n        }\n    };\n    SpatialNavigationService.prototype.saveLastFocusedChildKey = function (component, focusKey) {\n        if (component) {\n            this.log('saveLastFocusedChildKey', \"\".concat(component.focusKey, \" lastFocusedChildKey set\"), focusKey);\n            // eslint-disable-next-line no-param-reassign\n            component.lastFocusedChildKey = focusKey;\n        }\n    };\n    SpatialNavigationService.prototype.log = function (functionName, debugString) {\n        var rest = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            rest[_i - 2] = arguments[_i];\n        }\n        if (this.debug) {\n            // eslint-disable-next-line no-console\n            console.log.apply(console, __spreadArray([\"%c\".concat(functionName, \"%c\").concat(debugString), \"background: \".concat(DEBUG_FN_COLORS[this.logIndex % DEBUG_FN_COLORS.length], \"; color: black; padding: 1px 5px;\"), 'background: #333; color: #BADA55; padding: 1px 5px;'], rest, false));\n        }\n    };\n    /**\n     * Returns the current focus key\n     */\n    SpatialNavigationService.prototype.getCurrentFocusKey = function () {\n        return this.focusKey;\n    };\n    /**\n     * Returns the focus key to which focus can be forced if there are force-focusable components.\n     * A component closest to the top left viewport corner (0,0) is returned.\n     */\n    SpatialNavigationService.prototype.getForcedFocusKey = function () {\n        var _a;\n        var forceFocusableComponents = Object.values(this.focusableComponents).filter(function (component) { return component.focusable && component.forceFocus; });\n        /**\n         * Searching of the top level component that is closest to the top left viewport corner (0,0).\n         * To achieve meaningful and coherent results, 'down' direction is forced.\n         */\n        var sortedForceFocusableComponents = this.sortSiblingsByPriority(forceFocusableComponents, {\n            x: 0,\n            y: 0,\n            width: 0,\n            height: 0,\n            left: 0,\n            top: 0,\n            right: 0,\n            bottom: 0,\n            node: null\n        }, 'down', exports.ROOT_FOCUS_KEY);\n        return (_a = sortedForceFocusableComponents[0]) === null || _a === void 0 ? void 0 : _a.focusKey;\n    };\n    /**\n     * This function tries to determine the next component to Focus\n     * It's either the target node OR the one down by the Tree if node has children components\n     * Based on \"targetFocusKey\" which means the \"intended component to focus\"\n     */\n    SpatialNavigationService.prototype.getNextFocusKey = function (targetFocusKey) {\n        var _this = this;\n        var targetComponent = this.focusableComponents[targetFocusKey];\n        /**\n         * Security check, if component doesn't exist, stay on the same focusKey\n         */\n        if (!targetComponent || this.nativeMode) {\n            return targetFocusKey;\n        }\n        var children = Object.values(this.focusableComponents).filter(function (component) {\n            return component.parentFocusKey === targetFocusKey && component.focusable;\n        });\n        if (children.length > 0) {\n            var lastFocusedChildKey = targetComponent.lastFocusedChildKey, preferredChildFocusKey = targetComponent.preferredChildFocusKey;\n            this.log('getNextFocusKey', 'lastFocusedChildKey is', lastFocusedChildKey);\n            this.log('getNextFocusKey', 'preferredChildFocusKey is', preferredChildFocusKey);\n            /**\n             * First of all trying to focus last focused child\n             */\n            if (lastFocusedChildKey &&\n                targetComponent.saveLastFocusedChild &&\n                this.isParticipatingFocusableComponent(lastFocusedChildKey)) {\n                this.log('getNextFocusKey', 'lastFocusedChildKey will be focused', lastFocusedChildKey);\n                return this.getNextFocusKey(lastFocusedChildKey);\n            }\n            /**\n             * If there is no lastFocusedChild, trying to focus the preferred focused key\n             */\n            if (preferredChildFocusKey &&\n                this.isParticipatingFocusableComponent(preferredChildFocusKey)) {\n                this.log('getNextFocusKey', 'preferredChildFocusKey will be focused', preferredChildFocusKey);\n                return this.getNextFocusKey(preferredChildFocusKey);\n            }\n            /**\n             * Otherwise, trying to focus something by coordinates\n             */\n            children.forEach(function (component) { return _this.updateLayout(component.focusKey); });\n            var childKey = getChildClosestToOrigin(children, this.writingDirection).focusKey;\n            this.log('getNextFocusKey', 'childKey will be focused', childKey);\n            return this.getNextFocusKey(childKey);\n        }\n        /**\n         * If no children, just return targetFocusKey back\n         */\n        this.log('getNextFocusKey', 'targetFocusKey', targetFocusKey);\n        return targetFocusKey;\n    };\n    SpatialNavigationService.prototype.addFocusable = function (_a) {\n        var focusKey = _a.focusKey, node = _a.node, parentFocusKey = _a.parentFocusKey, onEnterPress = _a.onEnterPress, onEnterRelease = _a.onEnterRelease, onBoundaryHit = _a.onBoundaryHit, onArrowPress = _a.onArrowPress, onArrowRelease = _a.onArrowRelease, onFocus = _a.onFocus, onBlur = _a.onBlur, saveLastFocusedChild = _a.saveLastFocusedChild, trackChildren = _a.trackChildren, onUpdateFocus = _a.onUpdateFocus, onUpdateHasFocusedChild = _a.onUpdateHasFocusedChild, preferredChildFocusKey = _a.preferredChildFocusKey, autoRestoreFocus = _a.autoRestoreFocus, forceFocus = _a.forceFocus, focusable = _a.focusable, isFocusBoundary = _a.isFocusBoundary, focusBoundaryDirections = _a.focusBoundaryDirections;\n        this.focusableComponents[focusKey] = {\n            focusKey: focusKey,\n            node: node,\n            parentFocusKey: parentFocusKey,\n            onEnterPress: onEnterPress,\n            onEnterRelease: onEnterRelease,\n            onBoundaryHit: onBoundaryHit,\n            onArrowPress: onArrowPress,\n            onArrowRelease: onArrowRelease,\n            onFocus: onFocus,\n            onBlur: onBlur,\n            onUpdateFocus: onUpdateFocus,\n            onUpdateHasFocusedChild: onUpdateHasFocusedChild,\n            saveLastFocusedChild: saveLastFocusedChild,\n            trackChildren: trackChildren,\n            preferredChildFocusKey: preferredChildFocusKey,\n            focusable: focusable,\n            isFocusBoundary: isFocusBoundary,\n            focusBoundaryDirections: focusBoundaryDirections,\n            autoRestoreFocus: autoRestoreFocus,\n            forceFocus: forceFocus,\n            lastFocusedChildKey: null,\n            layout: {\n                x: 0,\n                y: 0,\n                width: 0,\n                height: 0,\n                left: 0,\n                top: 0,\n                right: 0,\n                bottom: 0,\n                /**\n                 * Node ref is also duplicated in layout to be reported in onFocus callback\n                 */\n                node: node\n            },\n            layoutUpdated: false\n        };\n        if (!node) {\n            // eslint-disable-next-line no-console\n            console.warn('Component added without a node reference. This will result in its coordinates being empty and may cause lost focus. Check the \"ref\" passed to \"useFocusable\": ', this.focusableComponents[focusKey]);\n        }\n        if (this.nativeMode) {\n            return;\n        }\n        this.updateLayout(focusKey);\n        this.log('addFocusable', 'Component added: ', this.focusableComponents[focusKey]);\n        /**\n         * If for some reason this component was already focused before it was added, call the update\n         */\n        if (focusKey === this.focusKey) {\n            this.setFocus(preferredChildFocusKey || focusKey);\n        }\n        /**\n         * Parent nodes are created after children, and child may focus itself.\n         * If so, it's required to check if parent lies on a path to focused child.\n         */\n        var currentComponent = this.focusableComponents[this.focusKey];\n        while (currentComponent) {\n            if (currentComponent.parentFocusKey === focusKey) {\n                this.updateParentsHasFocusedChild(this.focusKey, {});\n                this.updateParentsLastFocusedChild(this.focusKey);\n                break;\n            }\n            currentComponent =\n                this.focusableComponents[currentComponent.parentFocusKey];\n        }\n    };\n    SpatialNavigationService.prototype.removeFocusable = function (_a) {\n        var focusKey = _a.focusKey;\n        var componentToRemove = this.focusableComponents[focusKey];\n        if (componentToRemove) {\n            var parentFocusKey = componentToRemove.parentFocusKey, onUpdateFocus = componentToRemove.onUpdateFocus;\n            onUpdateFocus(false);\n            this.log('removeFocusable', 'Component removed: ', componentToRemove);\n            delete this.focusableComponents[focusKey];\n            var hadFocusedChild = this.parentsHavingFocusedChild.includes(focusKey);\n            this.parentsHavingFocusedChild = this.parentsHavingFocusedChild.filter(function (parentWithFocusedChild) { return parentWithFocusedChild !== focusKey; });\n            var parentComponent = this.focusableComponents[parentFocusKey];\n            var isFocused = focusKey === this.focusKey;\n            /**\n             * If the component was stored as lastFocusedChild, clear lastFocusedChildKey from parent\n             */\n            if (parentComponent && parentComponent.lastFocusedChildKey === focusKey) {\n                parentComponent.lastFocusedChildKey = null;\n            }\n            if (this.nativeMode) {\n                return;\n            }\n            /**\n             * If the component was also focused at this time, OR had focused child, focus its parent -> it will focus another child\n             * Normally the order of components unmount is children -> parents, but sometimes parent can be removed before the child\n             * So we need to check not only for the current Leaf component focus state, but also if it was a Parent that had focused child\n             */\n            if ((isFocused || hadFocusedChild) &&\n                parentComponent &&\n                parentComponent.autoRestoreFocus) {\n                this.log('removeFocusable', 'Component removed: ', isFocused ? 'Leaf component' : 'Container component', 'Auto restoring focus to: ', parentFocusKey);\n                /**\n                 * Focusing parent with a slight delay\n                 * This is to avoid multiple focus restorations if multiple children getting unmounted in one render cycle\n                 */\n                this.setFocusDebounced(parentFocusKey);\n            }\n        }\n    };\n    SpatialNavigationService.prototype.getNodeLayoutByFocusKey = function (focusKey) {\n        var component = this.focusableComponents[focusKey];\n        if (component) {\n            this.updateLayout(component.focusKey);\n            return component.layout;\n        }\n        return null;\n    };\n    SpatialNavigationService.prototype.setCurrentFocusedKey = function (newFocusKey, focusDetails) {\n        var _a, _b, _c, _d;\n        if (this.isFocusableComponent(this.focusKey) &&\n            newFocusKey !== this.focusKey) {\n            var oldComponent = this.focusableComponents[this.focusKey];\n            oldComponent.onUpdateFocus(false);\n            oldComponent.onBlur(this.getNodeLayoutByFocusKey(this.focusKey), focusDetails);\n            (_b = (_a = oldComponent.node) === null || _a === void 0 ? void 0 : _a.removeAttribute) === null || _b === void 0 ? void 0 : _b.call(_a, 'data-focused');\n            this.log('setCurrentFocusedKey', 'onBlur', oldComponent);\n        }\n        this.focusKey = newFocusKey;\n        if (this.isFocusableComponent(this.focusKey)) {\n            var newComponent = this.focusableComponents[this.focusKey];\n            if (this.shouldFocusDOMNode && newComponent.node) {\n                newComponent.node.focus(this.domNodeFocusOptions);\n            }\n            (_d = (_c = newComponent.node) === null || _c === void 0 ? void 0 : _c.setAttribute) === null || _d === void 0 ? void 0 : _d.call(_c, 'data-focused', 'true');\n            newComponent.onUpdateFocus(true);\n            newComponent.onFocus(this.getNodeLayoutByFocusKey(this.focusKey), focusDetails);\n            this.log('setCurrentFocusedKey', 'onFocus', newComponent);\n        }\n    };\n    SpatialNavigationService.prototype.updateParentsHasFocusedChild = function (focusKey, focusDetails) {\n        var _this = this;\n        var parents = [];\n        var currentComponent = this.focusableComponents[focusKey];\n        /**\n         * Recursively iterate the tree up and find all the parents' focus keys\n         */\n        while (currentComponent) {\n            var parentFocusKey = currentComponent.parentFocusKey;\n            var parentComponent = this.focusableComponents[parentFocusKey];\n            if (parentComponent) {\n                var currentParentFocusKey = parentComponent.focusKey;\n                parents.push(currentParentFocusKey);\n            }\n            currentComponent = parentComponent;\n        }\n        var parentsToRemoveFlag = (0, utils_1.difference)(this.parentsHavingFocusedChild, parents);\n        var parentsToAddFlag = (0, utils_1.difference)(parents, this.parentsHavingFocusedChild);\n        parentsToRemoveFlag.forEach(function (parentFocusKey) {\n            var parentComponent = _this.focusableComponents[parentFocusKey];\n            if (parentComponent && parentComponent.trackChildren) {\n                parentComponent.onUpdateHasFocusedChild(false);\n            }\n            _this.onIntermediateNodeBecameBlurred(parentFocusKey, focusDetails);\n        });\n        parentsToAddFlag.forEach(function (parentFocusKey) {\n            var parentComponent = _this.focusableComponents[parentFocusKey];\n            if (parentComponent && parentComponent.trackChildren) {\n                parentComponent.onUpdateHasFocusedChild(true);\n            }\n            _this.onIntermediateNodeBecameFocused(parentFocusKey, focusDetails);\n        });\n        this.parentsHavingFocusedChild = parents;\n    };\n    SpatialNavigationService.prototype.updateParentsLastFocusedChild = function (focusKey) {\n        var currentComponent = this.focusableComponents[focusKey];\n        /**\n         * Recursively iterate the tree up and update all the parent's lastFocusedChild\n         */\n        while (currentComponent) {\n            var parentFocusKey = currentComponent.parentFocusKey;\n            var parentComponent = this.focusableComponents[parentFocusKey];\n            if (parentComponent) {\n                this.saveLastFocusedChildKey(parentComponent, currentComponent.focusKey);\n            }\n            currentComponent = parentComponent;\n        }\n    };\n    SpatialNavigationService.prototype.getKeyMap = function () {\n        return this.keyMap;\n    };\n    SpatialNavigationService.prototype.setKeyMap = function (keyMap) {\n        this.keyMap = __assign(__assign({}, this.getKeyMap()), normalizeKeyMap(keyMap));\n    };\n    SpatialNavigationService.prototype.isFocusableComponent = function (focusKey) {\n        return !!this.focusableComponents[focusKey];\n    };\n    /**\n     * Checks whether the focusableComponent is actually participating in spatial navigation (in other words, is a\n     * 'focusable' focusableComponent). Seems less confusing than calling it isFocusableFocusableComponent()\n     */\n    SpatialNavigationService.prototype.isParticipatingFocusableComponent = function (focusKey) {\n        return (this.isFocusableComponent(focusKey) &&\n            this.focusableComponents[focusKey].focusable);\n    };\n    SpatialNavigationService.prototype.onIntermediateNodeBecameFocused = function (focusKey, focusDetails) {\n        if (this.isParticipatingFocusableComponent(focusKey)) {\n            this.focusableComponents[focusKey].onFocus(this.getNodeLayoutByFocusKey(focusKey), focusDetails);\n        }\n    };\n    SpatialNavigationService.prototype.onIntermediateNodeBecameBlurred = function (focusKey, focusDetails) {\n        if (this.isParticipatingFocusableComponent(focusKey)) {\n            this.focusableComponents[focusKey].onBlur(this.getNodeLayoutByFocusKey(focusKey), focusDetails);\n        }\n    };\n    SpatialNavigationService.prototype.pause = function () {\n        this.paused = true;\n    };\n    SpatialNavigationService.prototype.resume = function () {\n        this.paused = false;\n    };\n    SpatialNavigationService.prototype.setFocus = function (focusKey, focusDetails) {\n        if (focusDetails === void 0) { focusDetails = {}; }\n        // Cancel any pending auto-restore focus calls if we are setting focus manually\n        this.setFocusDebounced.cancel();\n        if (!this.enabled) {\n            return;\n        }\n        this.log('setFocus', 'focusKey', focusKey);\n        /**\n         * When focusKey is not provided or is equal to `ROOT_FOCUS_KEY`, an attempt is made,\n         * to force focus one of the Focusable Containers, that have \"forceFocus\" flag enabled.\n         * A component closest to the top left viewport corner (0,0) is force-focused.\n         */\n        if (!focusKey || focusKey === exports.ROOT_FOCUS_KEY) {\n            // eslint-disable-next-line no-param-reassign\n            focusKey = this.getForcedFocusKey();\n        }\n        var newFocusKey = this.getNextFocusKey(focusKey);\n        this.log('setFocus', 'newFocusKey', newFocusKey);\n        this.setCurrentFocusedKey(newFocusKey, focusDetails);\n        this.updateParentsHasFocusedChild(newFocusKey, focusDetails);\n        this.updateParentsLastFocusedChild(newFocusKey);\n    };\n    SpatialNavigationService.prototype.updateAllLayouts = function () {\n        var _this = this;\n        if (!this.enabled || this.nativeMode) {\n            return;\n        }\n        Object.keys(this.focusableComponents).forEach(function (focusKey) {\n            _this.updateLayout(focusKey);\n        });\n    };\n    SpatialNavigationService.prototype.updateLayout = function (focusKey) {\n        var component = this.focusableComponents[focusKey];\n        if (!component || this.nativeMode || component.layoutUpdated) {\n            return;\n        }\n        var node = component.node;\n        var layout = this.useGetBoundingClientRect\n            ? (0, measureLayout_1.getBoundingClientRect)(node)\n            : (0, measureLayout_1.default)(node);\n        component.layout = __assign(__assign({}, layout), { node: node });\n    };\n    SpatialNavigationService.prototype.updateFocusable = function (focusKey, _a) {\n        var node = _a.node, preferredChildFocusKey = _a.preferredChildFocusKey, focusable = _a.focusable, isFocusBoundary = _a.isFocusBoundary, focusBoundaryDirections = _a.focusBoundaryDirections, onEnterPress = _a.onEnterPress, onEnterRelease = _a.onEnterRelease, onBoundaryHit = _a.onBoundaryHit, onArrowPress = _a.onArrowPress, onFocus = _a.onFocus, onBlur = _a.onBlur;\n        if (this.nativeMode) {\n            return;\n        }\n        var component = this.focusableComponents[focusKey];\n        if (component) {\n            component.preferredChildFocusKey = preferredChildFocusKey;\n            component.focusable = focusable;\n            component.isFocusBoundary = isFocusBoundary;\n            component.focusBoundaryDirections = focusBoundaryDirections;\n            component.onEnterPress = onEnterPress;\n            component.onEnterRelease = onEnterRelease;\n            component.onBoundaryHit = onBoundaryHit;\n            component.onArrowPress = onArrowPress;\n            component.onFocus = onFocus;\n            component.onBlur = onBlur;\n            if (node) {\n                component.node = node;\n            }\n        }\n    };\n    SpatialNavigationService.prototype.isNativeMode = function () {\n        return this.nativeMode;\n    };\n    SpatialNavigationService.prototype.doesFocusableExist = function (focusKey) {\n        return !!this.focusableComponents[focusKey];\n    };\n    /**\n     * This function updates the writing direction\n     * @param rtl whether the writing direction is right-to-left\n     */\n    SpatialNavigationService.prototype.updateRtl = function (rtl) {\n        this.writingDirection = rtl ? WritingDirection_1.default.RTL : WritingDirection_1.default.LTR;\n    };\n    return SpatialNavigationService;\n}());\n/**\n * Export singleton\n */\nexports.SpatialNavigation = new SpatialNavigationService();\nexports.init = exports.SpatialNavigation.init, exports.setThrottle = exports.SpatialNavigation.setThrottle, exports.destroy = exports.SpatialNavigation.destroy, exports.setKeyMap = exports.SpatialNavigation.setKeyMap, exports.setFocus = exports.SpatialNavigation.setFocus, exports.navigateByDirection = exports.SpatialNavigation.navigateByDirection, exports.pause = exports.SpatialNavigation.pause, exports.resume = exports.SpatialNavigation.resume, exports.updateAllLayouts = exports.SpatialNavigation.updateAllLayouts, exports.getCurrentFocusKey = exports.SpatialNavigation.getCurrentFocusKey, exports.doesFocusableExist = exports.SpatialNavigation.doesFocusableExist, exports.updateRtl = exports.SpatialNavigation.updateRtl;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar WritingDirection_1 = __importDefault(require(\"./WritingDirection\"));\n// We'll make VisualDebugger no-op for any environments lacking a DOM (e.g. SSR and React Native non-web platforms).\nvar hasDOM = typeof window !== 'undefined' && window.document;\nvar WIDTH = hasDOM ? window.innerWidth : 0;\nvar HEIGHT = hasDOM ? window.innerHeight : 0;\nvar VisualDebugger = /** @class */ (function () {\n    function VisualDebugger(writingDirection) {\n        if (hasDOM) {\n            this.debugCtx = VisualDebugger.createCanvas('sn-debug', '1010', writingDirection);\n            this.layoutsCtx = VisualDebugger.createCanvas('sn-layouts', '1000', writingDirection);\n            this.writingDirection = writingDirection;\n        }\n    }\n    VisualDebugger.createCanvas = function (id, zIndex, writingDirection) {\n        var canvas = document.querySelector(\"#\".concat(id)) || document.createElement('canvas');\n        canvas.setAttribute('id', id);\n        canvas.setAttribute('dir', writingDirection === WritingDirection_1.default.LTR ? 'ltr' : 'rtl');\n        var ctx = canvas.getContext('2d');\n        canvas.style.zIndex = zIndex;\n        canvas.style.position = 'fixed';\n        canvas.style.top = '0';\n        canvas.style.left = '0';\n        document.body.appendChild(canvas);\n        canvas.width = WIDTH;\n        canvas.height = HEIGHT;\n        return ctx;\n    };\n    VisualDebugger.prototype.clear = function () {\n        if (!hasDOM) {\n            return;\n        }\n        this.debugCtx.clearRect(0, 0, WIDTH, HEIGHT);\n    };\n    VisualDebugger.prototype.clearLayouts = function () {\n        if (!hasDOM) {\n            return;\n        }\n        this.layoutsCtx.clearRect(0, 0, WIDTH, HEIGHT);\n    };\n    VisualDebugger.prototype.drawLayout = function (layout, focusKey, parentFocusKey) {\n        if (!hasDOM) {\n            return;\n        }\n        this.layoutsCtx.strokeStyle = 'green';\n        this.layoutsCtx.strokeRect(layout.left, layout.top, layout.width, layout.height);\n        this.layoutsCtx.font = '8px monospace';\n        this.layoutsCtx.fillStyle = 'red';\n        var horizontalStartDirection = this.writingDirection === WritingDirection_1.default.LTR ? 'left' : 'right';\n        var horizontalStartCoordinate = layout[horizontalStartDirection];\n        this.layoutsCtx.fillText(focusKey, horizontalStartCoordinate, layout.top + 10);\n        this.layoutsCtx.fillText(parentFocusKey, horizontalStartCoordinate, layout.top + 25);\n        this.layoutsCtx.fillText(\"\".concat(horizontalStartDirection, \": \").concat(horizontalStartCoordinate), horizontalStartCoordinate, layout.top + 40);\n        this.layoutsCtx.fillText(\"top: \".concat(layout.top), horizontalStartCoordinate, layout.top + 55);\n    };\n    VisualDebugger.prototype.drawPoint = function (x, y, color, size) {\n        if (color === void 0) { color = 'blue'; }\n        if (size === void 0) { size = 10; }\n        if (!hasDOM) {\n            return;\n        }\n        this.debugCtx.strokeStyle = color;\n        this.debugCtx.lineWidth = 3;\n        this.debugCtx.strokeRect(x - size / 2, y - size / 2, size, size);\n    };\n    return VisualDebugger;\n}());\nexports.default = VisualDebugger;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar WritingDirection;\n(function (WritingDirection) {\n    WritingDirection[WritingDirection[\"LTR\"] = 0] = \"LTR\";\n    WritingDirection[WritingDirection[\"RTL\"] = 1] = \"RTL\";\n})(WritingDirection || (WritingDirection = {}));\nexports.default = WritingDirection;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./useFocusable\"), exports);\n__exportStar(require(\"./useFocusContext\"), exports);\n__exportStar(require(\"./SpatialNavigation\"), exports);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getBoundingClientRect = void 0;\nvar ELEMENT_NODE = 1;\nvar getRect = function (node) {\n    var offsetParent = node.offsetParent;\n    var height = node.offsetHeight;\n    var width = node.offsetWidth;\n    var left = node.offsetLeft;\n    var top = node.offsetTop;\n    while (offsetParent && offsetParent.nodeType === ELEMENT_NODE) {\n        left += offsetParent.offsetLeft - offsetParent.scrollLeft;\n        top += offsetParent.offsetTop - offsetParent.scrollTop;\n        offsetParent = offsetParent.offsetParent;\n    }\n    return {\n        height: height,\n        left: left,\n        top: top,\n        width: width\n    };\n};\nvar measureLayout = function (node) {\n    var relativeNode = node && node.parentElement;\n    if (node && relativeNode) {\n        var relativeRect = getRect(relativeNode);\n        var _a = getRect(node), height = _a.height, left = _a.left, top_1 = _a.top, width = _a.width;\n        var x = left - relativeRect.left;\n        var y = top_1 - relativeRect.top;\n        return {\n            x: x,\n            y: y,\n            width: width,\n            height: height,\n            left: left,\n            top: top_1,\n            get right() {\n                return this.left + this.width;\n            },\n            get bottom() {\n                return this.top + this.height;\n            }\n        };\n    }\n    return {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0,\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0\n    };\n};\nexports.default = measureLayout;\nvar getBoundingClientRect = function (node) {\n    if (node && node.getBoundingClientRect) {\n        var rect = node.getBoundingClientRect();\n        return {\n            x: rect.x,\n            y: rect.y,\n            width: rect.width,\n            height: rect.height,\n            left: rect.left,\n            top: rect.top,\n            get right() {\n                return this.left + this.width;\n            },\n            get bottom() {\n                return this.top + this.height;\n            }\n        };\n    }\n    return {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0,\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0\n    };\n};\nexports.getBoundingClientRect = getBoundingClientRect;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useFocusContext = exports.FocusContext = void 0;\nvar react_1 = require(\"react\");\nvar SpatialNavigation_1 = require(\"./SpatialNavigation\");\nexports.FocusContext = (0, react_1.createContext)(SpatialNavigation_1.ROOT_FOCUS_KEY);\nexports.FocusContext.displayName = 'FocusContext';\n/** @internal */\nvar useFocusContext = function () { return (0, react_1.useContext)(exports.FocusContext); };\nexports.useFocusContext = useFocusContext;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useFocusable = void 0;\nvar react_1 = require(\"react\");\nvar SpatialNavigation_1 = require(\"./SpatialNavigation\");\nvar useFocusContext_1 = require(\"./useFocusContext\");\nvar utils_1 = require(\"./utils\");\nvar useFocusableHook = function (_a) {\n    var _b = _a === void 0 ? {} : _a, _c = _b.focusable, focusable = _c === void 0 ? true : _c, _d = _b.saveLastFocusedChild, saveLastFocusedChild = _d === void 0 ? true : _d, _e = _b.trackChildren, trackChildren = _e === void 0 ? false : _e, _f = _b.autoRestoreFocus, autoRestoreFocus = _f === void 0 ? true : _f, _g = _b.forceFocus, forceFocus = _g === void 0 ? false : _g, _h = _b.isFocusBoundary, isFocusBoundary = _h === void 0 ? false : _h, focusBoundaryDirections = _b.focusBoundaryDirections, propFocusKey = _b.focusKey, preferredChildFocusKey = _b.preferredChildFocusKey, _j = _b.onEnterPress, onEnterPress = _j === void 0 ? utils_1.noop : _j, _k = _b.onEnterRelease, onEnterRelease = _k === void 0 ? utils_1.noop : _k, _l = _b.onBoundaryHit, onBoundaryHit = _l === void 0 ? utils_1.noop : _l, _m = _b.onArrowPress, onArrowPress = _m === void 0 ? function () { return true; } : _m, _o = _b.onArrowRelease, onArrowRelease = _o === void 0 ? utils_1.noop : _o, _p = _b.onFocus, onFocus = _p === void 0 ? utils_1.noop : _p, _q = _b.onBlur, onBlur = _q === void 0 ? utils_1.noop : _q, extraProps = _b.extraProps;\n    var onEnterPressHandler = (0, react_1.useCallback)(function (details) {\n        onEnterPress(extraProps, details);\n    }, [onEnterPress, extraProps]);\n    var onEnterReleaseHandler = (0, react_1.useCallback)(function () {\n        onEnterRelease(extraProps);\n    }, [onEnterRelease, extraProps]);\n    var onBoundaryHitHandler = (0, react_1.useCallback)(function (boundaryDirection) {\n        onBoundaryHit(boundaryDirection, extraProps);\n    }, [extraProps, onBoundaryHit]);\n    var onArrowPressHandler = (0, react_1.useCallback)(function (direction, details) {\n        return onArrowPress(direction, extraProps, details);\n    }, [extraProps, onArrowPress]);\n    var onArrowReleaseHandler = (0, react_1.useCallback)(function (direction) {\n        onArrowRelease(direction, extraProps);\n    }, [onArrowRelease, extraProps]);\n    var onFocusHandler = (0, react_1.useCallback)(function (layout, details) {\n        onFocus(layout, extraProps, details);\n    }, [extraProps, onFocus]);\n    var onBlurHandler = (0, react_1.useCallback)(function (layout, details) {\n        onBlur(layout, extraProps, details);\n    }, [extraProps, onBlur]);\n    var ref = (0, react_1.useRef)(null);\n    var _r = (0, react_1.useState)(false), focused = _r[0], setFocused = _r[1];\n    var _s = (0, react_1.useState)(false), hasFocusedChild = _s[0], setHasFocusedChild = _s[1];\n    var parentFocusKey = (0, useFocusContext_1.useFocusContext)();\n    /**\n     * Either using the propFocusKey passed in, or generating a random one\n     */\n    var focusKey = (0, react_1.useMemo)(function () { return propFocusKey || (0, utils_1.uniqueId)('sn:focusable-item-'); }, [propFocusKey]);\n    var focusSelf = (0, react_1.useCallback)(function (focusDetails) {\n        if (focusDetails === void 0) { focusDetails = {}; }\n        SpatialNavigation_1.SpatialNavigation.setFocus(focusKey, focusDetails);\n    }, [focusKey]);\n    (0, react_1.useEffect)(function () {\n        var node = ref.current;\n        SpatialNavigation_1.SpatialNavigation.addFocusable({\n            focusKey: focusKey,\n            node: node,\n            parentFocusKey: parentFocusKey,\n            preferredChildFocusKey: preferredChildFocusKey,\n            onEnterPress: onEnterPressHandler,\n            onEnterRelease: onEnterReleaseHandler,\n            onBoundaryHit: onBoundaryHitHandler,\n            onArrowPress: onArrowPressHandler,\n            onArrowRelease: onArrowReleaseHandler,\n            onFocus: onFocusHandler,\n            onBlur: onBlurHandler,\n            onUpdateFocus: function (isFocused) {\n                if (isFocused === void 0) { isFocused = false; }\n                return setFocused(isFocused);\n            },\n            onUpdateHasFocusedChild: function (isFocused) {\n                if (isFocused === void 0) { isFocused = false; }\n                return setHasFocusedChild(isFocused);\n            },\n            saveLastFocusedChild: saveLastFocusedChild,\n            trackChildren: trackChildren,\n            isFocusBoundary: isFocusBoundary,\n            focusBoundaryDirections: focusBoundaryDirections,\n            autoRestoreFocus: autoRestoreFocus,\n            forceFocus: forceFocus,\n            focusable: focusable\n        });\n        return function () {\n            SpatialNavigation_1.SpatialNavigation.removeFocusable({\n                focusKey: focusKey\n            });\n        };\n    }, []); // eslint-disable-line react-hooks/exhaustive-deps\n    (0, react_1.useEffect)(function () {\n        var node = ref.current;\n        SpatialNavigation_1.SpatialNavigation.updateFocusable(focusKey, {\n            node: node,\n            preferredChildFocusKey: preferredChildFocusKey,\n            focusable: focusable,\n            isFocusBoundary: isFocusBoundary,\n            focusBoundaryDirections: focusBoundaryDirections,\n            onEnterPress: onEnterPressHandler,\n            onEnterRelease: onEnterReleaseHandler,\n            onBoundaryHit: onBoundaryHitHandler,\n            onArrowPress: onArrowPressHandler,\n            onArrowRelease: onArrowReleaseHandler,\n            onFocus: onFocusHandler,\n            onBlur: onBlurHandler\n        });\n    }, [\n        focusKey,\n        preferredChildFocusKey,\n        focusable,\n        isFocusBoundary,\n        focusBoundaryDirections,\n        onEnterPressHandler,\n        onEnterReleaseHandler,\n        onBoundaryHitHandler,\n        onArrowPressHandler,\n        onArrowReleaseHandler,\n        onFocusHandler,\n        onBlurHandler\n    ]);\n    return {\n        ref: ref,\n        focusSelf: focusSelf,\n        focused: focused,\n        hasFocusedChild: hasFocusedChild,\n        focusKey: focusKey // returns either the same focusKey as passed in, or generated one\n    };\n};\nexports.useFocusable = useFocusableHook;\n","\"use strict\";\n/* eslint-disable import/prefer-default-export */\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.shuffle = exports.uniqueId = exports.noop = exports.throttle = exports.debounce = exports.difference = exports.findKey = void 0;\nvar findKey = function (obj, predicate) {\n    if (predicate === void 0) { predicate = function (o) { return !!o; }; }\n    return Object.keys(obj).find(function (key) { return predicate(obj[key], key, obj); });\n};\nexports.findKey = findKey;\n/**\n * This function only works for string or numbers since Set checks for reference equality,\n * meaning objects wouldn't work.\n */\nvar difference = function (array) {\n    var values = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        values[_i - 1] = arguments[_i];\n    }\n    var exclusionSet = new Set(values.flat());\n    return array.filter(function (item) { return !exclusionSet.has(item); });\n};\nexports.difference = difference;\nvar noop = function () { };\nexports.noop = noop;\nvar counter = 0;\nvar uniqueId = function (prefix) {\n    if (prefix === void 0) { prefix = ''; }\n    counter += 1;\n    return \"\".concat(prefix).concat(counter);\n};\nexports.uniqueId = uniqueId;\nvar shuffle = function (array) {\n    var _a;\n    var shuffledArray = __spreadArray([], array, true);\n    // Fisher-Yates (Knuth) shuffle algorithm\n    for (var i = shuffledArray.length - 1; i > 0; i -= 1) {\n        var j = Math.floor(Math.random() * (i + 1));\n        _a = [shuffledArray[j], shuffledArray[i]], shuffledArray[i] = _a[0], shuffledArray[j] = _a[1]; // Swap elements\n    }\n    return shuffledArray;\n};\nexports.shuffle = shuffle;\nvar debounce = function (func, wait, options) {\n    var timeoutId = null;\n    var lastArgs = null;\n    var invokeFunc = function (args) {\n        func.apply(void 0, args);\n    };\n    var debounced = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        lastArgs = args;\n        var _a = options || {}, _b = _a.leading, leading = _b === void 0 ? false : _b, _c = _a.trailing, trailing = _c === void 0 ? true : _c;\n        if (leading && !timeoutId) {\n            invokeFunc(args); // Call immediately on the first call\n        }\n        if (timeoutId)\n            clearTimeout(timeoutId);\n        timeoutId = setTimeout(function () {\n            if (trailing && lastArgs) {\n                invokeFunc(lastArgs); // Call on trailing edge\n            }\n            timeoutId = null;\n        }, wait);\n    };\n    // Add the cancel method to clear any pending timeout\n    debounced.cancel = function () {\n        if (timeoutId)\n            clearTimeout(timeoutId);\n        timeoutId = null;\n    };\n    return debounced;\n};\nexports.debounce = debounce;\nvar throttle = function (func, wait, _a) {\n    var _b = _a === void 0 ? {} : _a, _c = _b.leading, leading = _c === void 0 ? true : _c, _d = _b.trailing, trailing = _d === void 0 ? true : _d;\n    var timeoutId = null;\n    var lastExecuted = 0;\n    var lastArgs = null;\n    var invokeFunc = function (args) {\n        func.apply(void 0, args);\n        lastExecuted = Date.now();\n    };\n    var throttled = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        lastArgs = args;\n        var now = Date.now();\n        var timeSinceLastCall = now - lastExecuted;\n        var remainingTime = wait - timeSinceLastCall;\n        if (remainingTime <= 0) {\n            if (leading) {\n                invokeFunc(args);\n            }\n        }\n        else if (trailing && !timeoutId) {\n            timeoutId = setTimeout(function () {\n                if (lastArgs) {\n                    invokeFunc(lastArgs);\n                }\n                timeoutId = null;\n            }, remainingTime);\n        }\n    };\n    throttled.cancel = function () {\n        if (timeoutId) {\n            clearTimeout(timeoutId);\n            timeoutId = null;\n        }\n        lastExecuted = 0; // Reset lastExecuted time to ensure it can be triggered again\n    };\n    return throttled;\n};\nexports.throttle = throttle;\n","module.exports = __WEBPACK_EXTERNAL_MODULE__156__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(607);\n"],"names":["root","factory","exports","module","require","define","amd","a","i","this","__WEBPACK_EXTERNAL_MODULE__156__","_a","__assign","Object","assign","t","s","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__spreadArray","to","from","pack","ar","l","Array","slice","concat","__importDefault","updateRtl","doesFocusableExist","getCurrentFocusKey","updateAllLayouts","resume","pause","navigateByDirection","setFocus","setKeyMap","destroy","setThrottle","init","SpatialNavigation","ROOT_FOCUS_KEY","VisualDebugger_1","WritingDirection_1","measureLayout_1","utils_1","DIRECTION_LEFT","DIRECTION_RIGHT","DIRECTION_UP","DIRECTION_DOWN","KEY_ENTER","DEFAULT_KEY_MAP","DEBUG_FN_COLORS","THROTTLE_OPTIONS","leading","trailing","SpatialNavigationService","focusableComponents","focusKey","parentsHavingFocusedChild","domNodeFocusOptions","enabled","nativeMode","throttle","throttleKeypresses","useGetBoundingClientRect","shouldFocusDOMNode","shouldUseNativeEvents","writingDirection","default","LTR","pressedKeys","paused","keyDownEventListener","keyUpEventListener","keyMap","bind","setFocusDebounced","debounce","debug","visualDebugger","logIndex","distanceCalculationMethod","getCutoffCoordinate","isVertical","isIncremental","isSibling","layout","itemStart","top","left","right","itemEnd","bottom","getRefCorners","direction","x","y","b","isAdjacentSlice","refCorners","siblingCorners","isVerticalDirection","refA","refB","siblingA","siblingB","coordinate","refCoordinateA","refCoordinateB","siblingCoordinateA","siblingCoordinateB","thresholdDistance","Math","max","min","getPrimaryAxisDistance","abs","getSecondaryAxisDistance","customDistanceCalculationFunction","refCoordinateCenter","siblingCoordinateCenter","refCoordinateEdgeMin","siblingCoordinateEdgeMin","refCoordinateEdgeMax","siblingCoordinateEdgeMax","minEdgeDistance","maxEdgeDistance","distancesToCompare","sortSiblingsByPriority","siblings","currentLayout","_this","sort","siblingCornersA","siblingCornersB","isAdjacentSliceA","isAdjacentSliceB","primaryAxisFunctionA","primaryAxisFunctionB","secondaryAxisFunctionA","secondaryAxisFunctionB","primaryAxisDistanceA","primaryAxisDistanceB","secondaryAxisDistanceA","totalDistancePointsA","priorityA","priorityB","log","drawPoint","_b","_c","_d","visualDebug","_e","_f","throttleParam","_g","_h","_j","_k","_l","_m","rtl","_o","_p","RTL","Number","isInteger","bindEventHandlers","draw_1","requestAnimationFrame","clearLayouts","keys","forEach","component","drawLayout","parentFocusKey","unbindEventHandlers","getEventType","keyCode","findKey","getKeyMap","codeList","includes","getKeyCode","event","code","key","window","addEventListener","eventType","preventDefault","stopPropagation","keysDetails","onEnterPress","preventDefaultNavigation","onArrowPress","clear","smartNavigate","keyDownEventListenerThrottled","cancel","onEnterRelease","onArrowRelease","removeEventListener","listener","focusable","focusDetails","validDirections","fromParentFocusKey","isIncrementalDirection","values","layoutUpdated","currentComponent","node","updateLayout","parentFocusKey_1","currentCutoffCoordinate_1","filter","siblingCutoffCoordinate","map","sibling","join","nextComponent","parentComponent","focusBoundaryDirections","isFocusBoundary","onBoundaryHit","getForcedFocusKey","saveLastFocusedChildKey","lastFocusedChildKey","functionName","debugString","rest","_i","console","forceFocusableComponents","forceFocus","width","height","getNextFocusKey","targetFocusKey","targetComponent","children","preferredChildFocusKey","saveLastFocusedChild","isParticipatingFocusableComponent","childKey","comparator","innerWidth","getChildClosestToOrigin","addFocusable","onFocus","onBlur","trackChildren","onUpdateFocus","onUpdateHasFocusedChild","autoRestoreFocus","warn","updateParentsHasFocusedChild","updateParentsLastFocusedChild","removeFocusable","componentToRemove","hadFocusedChild","parentWithFocusedChild","isFocused","getNodeLayoutByFocusKey","setCurrentFocusedKey","newFocusKey","isFocusableComponent","oldComponent","removeAttribute","newComponent","focus","setAttribute","parents","currentParentFocusKey","push","parentsToRemoveFlag","difference","parentsToAddFlag","onIntermediateNodeBecameBlurred","onIntermediateNodeBecameFocused","newKeyMap","entries","isArray","normalizeKeyMap","getBoundingClientRect","updateFocusable","isNativeMode","hasDOM","document","WIDTH","HEIGHT","innerHeight","VisualDebugger","debugCtx","createCanvas","layoutsCtx","id","zIndex","canvas","querySelector","createElement","ctx","getContext","style","position","body","appendChild","clearRect","strokeStyle","strokeRect","font","fillStyle","horizontalStartDirection","horizontalStartCoordinate","fillText","color","size","lineWidth","WritingDirection","__exportStar","getRect","offsetParent","offsetHeight","offsetWidth","offsetLeft","offsetTop","nodeType","scrollLeft","scrollTop","relativeNode","parentElement","relativeRect","top_1","rect","useFocusContext","FocusContext","react_1","SpatialNavigation_1","createContext","displayName","useContext","useFocusable","useFocusContext_1","propFocusKey","noop","_q","extraProps","onEnterPressHandler","useCallback","details","onEnterReleaseHandler","onBoundaryHitHandler","boundaryDirection","onArrowPressHandler","onArrowReleaseHandler","onFocusHandler","onBlurHandler","ref","useRef","_r","useState","focused","setFocused","_s","hasFocusedChild","setHasFocusedChild","useMemo","uniqueId","focusSelf","useEffect","current","shuffle","obj","predicate","find","array","exclusionSet","Set","flat","item","has","counter","prefix","shuffledArray","j","floor","random","func","wait","options","timeoutId","lastArgs","invokeFunc","args","debounced","clearTimeout","setTimeout","lastExecuted","Date","now","throttled","timeSinceLastCall","remainingTime","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__"],"sourceRoot":""}